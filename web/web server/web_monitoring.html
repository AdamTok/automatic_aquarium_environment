<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Firebase Toggle Switch</title>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-database.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.0.4/css/all.css"
    />
    <style>
      body {
        background: #031321;
      }

      .wrapper {
        height: 100vh;
        width: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }

      .progress {
        margin: 30px auto;
        width: 70%;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
      }

      .toggle-btn {
        width: 80px;
        height: 40px;
        background: gray;
        border-radius: 30px;
        padding: 5px;
        transition: all 300ms ease-in-out;
        cursor: pointer;
      }

      .toggle-btn > .inner-circle {
        width: 40px;
        height: 40px;
        background: white;
        border-radius: 50%;
        transition: all 300ms ease-in-out;
      }

      .toggle-btn.active {
        background: #21ecf3;
        box-shadow: 0 0 10px #21ecf3, 0 0 40px #21ecf3, 0 0 80px #21ecf3;
        transition-delay: 0.5s;
      }

      .toggle-btn.active > .inner-circle {
        margin-left: 40px;
      }

      .icon1 {
        color: #fff;
        margin: 10px auto;
      }
    </style>
  </head>
  <body>
    <div class="wrapper">
      <a class="icon1">
        <i class="fas fa-4x fa-tv"></i>
      </a>
      <div class="progress">
        <div class="toggle-btn" id="toggleBtn" onclick="toggleLED()">
          <div class="inner-circle"></div>
        </div>
      </div>
    </div>

    <script>
      var firebaseConfig = {
        apiKey: "AIzaSyAdRwS8xHxnCMdeS9Bqj5z2-SDd0Ju-e34",
        authDomain: "dbfirebaseauth-b25cc.firebaseapp.com",
        databaseURL: "https://dbfirebaseauth-b25cc-default-rtdb.firebaseio.com",
        projectId: "dbfirebaseauth-b25cc",
        storageBucket: "dbfirebaseauth-b25cc.appspot.com",
        messagingSenderId: "337917312217",
        appId: "1:337917312217:web:7d859e0bff05eeea7b92c8",
      };

      firebase.initializeApp(firebaseConfig);
      var database = firebase.database();
      var toggleBtn = document.getElementById("toggleBtn");

      function toggleLED() {
        database.ref("TAIoT/LED").once("value", function (snapshot) {
          var currentStatus = snapshot.val();

          // Toggle LED status
          var newStatus = currentStatus === "on" ? "off" : "on";

          // Update the LED status in the database
          database.ref("TAIoT/LED").set(newStatus);

          // Update button display
          updateButtonDisplay(newStatus);
        });
      }

      function updateButtonDisplay(status) {
        if (status === "off") {
          toggleBtn.classList.remove("active");
        } else {
          toggleBtn.classList.add("active");
        }
      }

      // Listen for changes to the LED status and update button display accordingly
      database
        .ref()
        .child("TAIoT/LED")
        .on("value", function (snapshot) {
          var status = snapshot.val();
          updateButtonDisplay(status);
        });
    </script>
  </body>
</html>
